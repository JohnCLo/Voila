var express = require('express');

var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server)
  , request = require('request')
  , ss = require('simple-statistics')
  , moment = require('moment');

var jf = require('jsonfile');

server.listen(5000);

app.use(express.static(__dirname + '/public'));

app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

var Quandl = require("quandl");
var quandl = new Quandl();

var options = {
    auth_token: "GCfKzLJiwuSxucYgqHMq"
}

quandl.configure(options);

var stocks = 
[ 'A',
  'AA',
  'AAL',
  'AAMC',
  'AAN',
  'AAON',
  'AAP',
  'AAPL',
  'AAT',
  'AAWW',
  'ABAX',
  'ABBV',
  'ABC',
  'ABCB',
  'ABCO',
  'ABFS',
  'ABG',
  'ABM',
  'ABMD',
  'ABT',
  'ACAD',
  'ACAS',
  'ACAT',
  'ACC',
  'ACCL',
  'ACCO',
  'ACE',
  'ACET',
  'ACFN',
  'ACGL',
  'ACHC',
  'ACHN',
  'ACI',
  'ACIW',
  'ACLS',
  'ACM',
  'ACN',
  'ACO',
  'ACOR',
  'ACRX',
  'ACT',
  'ACTG',
  'ACW',
  'ACXM',
  'ADBE',
  'ADC',
  'ADES',
  'ADI',
  'ADM',
  'ADNC',
  'ADP',
  'ADS',
  'ADSK',
  'ADT',
  'ADTN',
  'ADUS',
  'ADVS',
  'AE',
  'AEC',
  'AEE',
  'AEGN',
  'AEGR',
  'AEIS',
  'AEL',
  'AEO',
  'AEP',
  'AEPI',
  'AERI',
  'AES',
  'AET',
  'AF',
  'AFAM',
  'AFFX',
  'AFG',
  'AFL',
  'AFOP',
  'AFSI',
  'AGCO',
  'AGEN',
  'AGII',
  'AGIO',
  'AGM',
  'AGN',
  'AGNC',
  'AGO',
  'AGX',
  'AGYS',
  'AHC',
  'AHH',
  'AHL',
  'AHP',
  'AHS',
  'AHT',
  'AI',
  'AIG',
  'AIMC',
  'AIN',
  'AINV',
  'AIQ',
  'AIR',
  'AIRM',
  'AIT',
  'AIV',
  'AIZ',
  'AJG',
  'AKAM',
  'AKR',
  'AKRX',
  'AKS',
  'AL',
  'ALB',
  'ALCO',
  'ALE',
  'ALEX',
  'ALG',
  'ALGN',
  'ALGT',
  'ALIM',
  'ALJ',
  'ALK',
  'ALKS',
  'ALL',
  'ALLE',
  'ALNY',
  'ALOG',
  'ALR',
  'ALSN',
  'ALTR',
  'ALX',
  'ALXN',
  'AMAG',
  'AMAT',
  'AMBA',
  'AMBC',
  'AMCC',
  'AMCX',
  'AMD',
  'AME',
  'AMED',
  'AMG',
  'AMGN',
  'AMKR',
  'AMNB',
  'AMP',
  'AMPE',
  'AMRC',
  'AMRI',
  'AMRS',
  'AMSC',
  'AMSF',
  'AMSG',
  'AMSWA',
  'AMT',
  'AMTD',
  'AMTG',
  'AMWD',
  'AMZN',
  'AN',
  'ANAC',
  'ANAD',
  'ANAT',
  'ANCX',
  'ANDE',
  'ANF',
  'ANGI',
  'ANGO',
  'ANH',
  'ANIK',
  'ANN',
  'ANR',
  'ANSS',
  'ANTM',
  'ANV',
  'AOI',
  'AOL',
  'AON',
  'AOS',
  'AOSL',
  'AP',
  'APA',
  'APAGF',
  'APAM',
  'APC',
  'APD',
  'APEI',
  'APH',
  'APL',
  'APOG',
  'APOL',
  'APP',
  'ARAY',
  'ARC',
  'ARCB',
  'ARCC',
  'ARE',
  'AREX',
  'ARG',
  'ARI',
  'ARIA',
  'ARII',
  'ARNA',
  'ARO',
  'AROW',
  'ARPI',
  'ARQL',
  'ARRS',
  'ARRY',
  'ARSD',
  'ARTC',
  'ARTNA',
  'ARUN',
  'ARW',
  'ARX',
  'ASBC',
  'ASCMA',
  'ASEI',
  'ASGN',
  'ASH',
  'ASNA',
  'ASPS',
  'ASTE',
  'AT',
  'ATEC',
  'ATHN',
  'ATI',
  'ATK',
  'ATLO',
  'ATMI',
  'ATML',
  'ATNI',
  'ATNY',
  'ATO',
  'ATR',
  'ATRC',
  'ATRI',
  'ATRO',
  'ATRS',
  'ATSG',
  'ATU',
  'ATVI',
  'ATW',
  'AUXL',
  'AVA',
  'AVAV',
  'AVB',
  'AVD',
  'AVEO',
  'AVG',
  'AVGO',
  'AVHI',
  'AVID',
  'AVIV',
  'AVNR',
  'AVNW',
  'AVP',
  'AVT',
  'AVX',
  'AVY',
  'AWAY',
  'AWH',
  'AWI',
  'AWK',
  'AWR',
  'AXAS',
  'AXDX',
  'AXE',
  'AXL',
  'AXLL',
  'AXP',
  'AXS',
  'AYI',
  'AYR',
  'AZO',
  'AZPN',
  'AZZ',
  'B',
  'BA',
  'BABY',
  'BAC',
  'BAGL',
  'BAGR',
  'BAH',
  'BALT',
  'BANC',
  'BANF',
  'BANR',
  'BAS',
  'BAX',
  'BBBY',
  'BBCN',
  'BBG',
  'BBGI',
  'BBNK',
  'BBOX',
  'BBRG',
  'BBSI',
  'BBT',
  'BBW',
  'BBX',
  'BBY',
  'BC',
  'BCC',
  'BCEI',
  'BCO',
  'BCOR',
  'BCOV',
  'BCPC',
  'BCR',
  'BCRX',
  'BDBD',
  'BDC',
  'BDE',
  'BDGE',
  'BDN',
  'BDSI',
  'BDX',
  'BEAM',
  'BEAT',
  'BEAV',
  'BEBE',
  'BECN',
  'BEE',
  'BELFB',
  'BEN',
  'BERY',
  'BFAM',
  'BFIN',
  'BFS',
  'BF_B',
  'BG',
  'BGC',
  'BGCP',
  'BGFV',
  'BGG',
  'BGS',
  'BH',
  'BHB',
  'BHE',
  'BHI',
  'BHLB',
  'BID',
  'BIG',
  'BIIB',
  'BIO',
  'BIOL',
  'BIOS',
  'BIRT',
  'BJRI',
  'BK',
  'BKCC',
  'BKD',
  'BKE',
  'BKH',
  'BKMU',
  'BKS',
  'BKU',
  'BKW',
  'BKYF',
  'BLDR',
  'BLK',
  'BLKB',
  'BLL',
  'BLMN',
  'BLOX',
  'BLT',
  'BLUE',
  'BLX',
  'BMI',
  'BMR',
  'BMRC',
  'BMRN',
  'BMS',
  'BMTC',
  'BMY',
  'BNCL',
  'BNCN',
  'BNFT',
  'BNNY',
  'BOBE',
  'BODY',
  'BOFI',
  'BOH',
  'BOKF',
  'BOLT',
  'BONT',
  'BOOM',
  'BPFH',
  'BPI',
  'BPOP',
  'BPTH',
  'BPZ',
  'BR',
  'BRC',
  'BRCD',
  'BRCM',
  'BREW',
  'BRKL',
  'BRKR',
  'BRKS',
  'BRK_B',
  'BRLI',
  'BRO',
  'BRS',
  'BRSS',
  'BRT',
  'BSET',
  'BSFT',
  'BSRR',
  'BSTC',
  'BSX',
  'BTH',
  'BTU',
  'BTX',
  'BURL',
  'BUSE',
  'BV',
  'BWA',
  'BWC',
  'BWINB',
  'BWLD',
  'BWS',
  'BXC',
  'BXP',
  'BXS',
  'BYD',
  'BYI',
  'BZH',
  'C',
  'CA',
  'CAB',
  'CAC',
  'CACB',
  'CACC',
  'CACI',
  'CAG',
  'CAH',
  'CAKE',
  'CALD',
  'CALL',
  'CALM',
  'CALX',
  'CAM',
  'CAMP',
  'CAP',
  'CAR',
  'CARB',
  'CAS',
  'CASH',
  'CASS',
  'CASY',
  'CAT',
  'CATM',
  'CATO',
  'CATY',
  'CAVM',
  'CB',
  'CBB',
  'CBEY',
  'CBF',
  'CBG',
  'CBI',
  'CBK',
  'CBL',
  'CBM',
  'CBOE',
  'CBR',
  'CBRL',
  'CBS',
  'CBSH',
  'CBST',
  'CBT',
  'CBU',
  'CBZ',
  'CCBG',
  'CCC',
  'CCE',
  'CCF',
  'CCG',
  'CCI',
  'CCK',
  'CCL',
  'CCMP',
  'CCNE',
  'CCO',
  'CCOI',
  'CCRN',
  'CCXI',
  'CDE',
  'CDI',
  'CDNS',
  'CDR',
  'CE',
  'CEB',
  'CECE',
  'CECO',
  'CELG',
  'CEMP',
  'CENTA',
  'CENX',
  'CERN',
  'CERS',
  'CETV',
  'CEVA',
  'CF',
  'CFFI',
  'CFFN',
  'CFI',
  'CFN',
  'CFNB',
  'CFNL',
  'CFR',
  'CFX',
  'CGI',
  'CGNX',
  'CHCO',
  'CHD',
  'CHDN',
  'CHDX',
  'CHE',
  'CHEF',
  'CHFC',
  'CHFN',
  'CHH',
  'CHK',
  'CHMG',
  'CHMT',
  'CHRW',
  'CHS',
  'CHSP',
  'CHTP',
  'CHTR',
  'CHUY',
  'CI',
  'CIA',
  'CIDM',
  'CIE',
  'CIEN',
  'CIFC',
  'CINF',
  'CIR',
  'CIT',
  'CIX',
  'CJES',
  'CKEC',
  'CKH',
  'CKP',
  'CL',
  'CLC',
  'CLCT',
  'CLD',
  'CLDT',
  'CLDX',
  'CLF',
  'CLFD',
  'CLGX',
  'CLH',
  'CLI',
  'CLMS',
  'CLNE',
  'CLR',
  'CLUB',
  'CLVS',
  'CLW',
  'CLX',
  'CMA',
  'CMC',
  'CMCO',
  'CMCSA',
  'CME',
  'CMG',
  'CMI',
  'CMLS',
  'CMN',
  'CMO',
  'CMP',
  'CMRX',
  'CMS',
  'CMTL',
  'CNA',
  'CNBC',
  'CNBKA',
  'CNC',
  'CNDO',
  'CNK',
  'CNL',
  'CNMD',
  'CNO',
  'CNOB',
  'CNP',
  'CNQR',
  'CNS',
  'CNSI',
  'CNSL',
  'CNVR',
  'CNW',
  'CNX',
  'COBZ',
  'COCO',
  'CODE',
  'COF',
  'COG',
  'COH',
  'COHR',
  'COHU',
  'COKE',
  'COL',
  'COLB',
  'COLM',
  'CONE',
  'CONN',
  'COO',
  'COP',
  'COR',
  'CORE',
  'CORT',
  'COST',
  'COUP',
  'COV',
  'COVS',
  'COWN',
  'CPA',
  'CPB',
  'CPE',
  'CPF',
  'CPHD',
  'CPK',
  'CPLA',
  'CPN',
  'CPRT',
  'CPSI',
  'CPSS',
  'CPST',
  'CPT',
  'CPWR',
  'CQB',
  'CR',
  'CRAI',
  'CRAY',
  'CREE',
  'CRI',
  'CRIS',
  'CRK',
  'CRL',
  'CRM',
  'CRMT',
  'CROX',
  'CRR',
  'CRRC',
  'CRS',
  'CRUS',
  'CRVL',
  'CRWN',
  'CRY',
  'CRZO',
  'CSBK',
  'CSC',
  'CSCD',
  'CSCO',
  'CSE',
  'CSFL',
  'CSG',
  'CSGP',
  'CSGS',
  'CSH',
  'CSII',
  'CSL',
  'CSOD',
  'CSS',
  'CST',
  'CSU',
  'CSV',
  'CSWC',
  'CSX',
  'CTAS',
  'CTB',
  'CTBI',
  'CTCT',
  'CTG',
  'CTIC',
  'CTL',
  'CTO',
  'CTRE',
  'CTRL',
  'CTRN',
  'CTRX',
  'CTS',
  'CTSH',
  'CTWS',
  'CTXS',
  'CUB',
  'CUBI',
  'CUI',
  'CUNB',
  'CUR',
  'CUTR',
  'CUZ',
  'CVA',
  'CVBF',
  'CVC',
  'CVCO',
  'CVD',
  'CVG',
  'CVGI',
  'CVGW',
  'CVI',
  'CVLT',
  'CVO',
  'CVS',
  'CVT',
  'CVX',
  'CW',
  'CWCO',
  'CWEI',
  'CWST',
  'CWT',
  'CXO',
  'CXW',
  'CY',
  'CYBX',
  'CYH',
  'CYN',
  'CYNI',
  'CYNO',
  'CYT',
  'CYTK',
  'CYTR',
  'CYTX',
  'CZNC',
  'CZR',
  'D',
  'DAKT',
  'DAL',
  'DAN',
  'DAR',
  'DATA',
  'DAVE',
  'DBD',
  'DCI',
  'DCO',
  'DCOM',
  'DCT',
  'DD',
  'DDD',
  'DDS',
  'DE',
  'DECK',
  'DEI',
  'DEL',
  'DELL',
  'DENN',
  'DEPO',
  'DEST',
  'DF',
  'DFRG',
  'DFS',
  'DFT',
  'DFZ',
  'DG',
  'DGAS',
  'DGI',
  'DGICA',
  'DGII',
  'DGX',
  'DHI',
  'DHIL',
  'DHR',
  'DHX',
  'DIN',
  'DIOD',
  'DIS',
  'DISCA',
  'DISH',
  'DJCO',
  'DK',
  'DKS',
  'DLB',
  'DLLR',
  'DLPH',
  'DLR',
  'DLTR',
  'DLX',
  'DMD',
  'DMND',
  'DMRC',
  'DNB',
  'DNDN',
  'DNKN',
  'DNR',
  'DO',
  'DOC',
  'DOOR',
  'DORM',
  'DOV',
  'DOW',
  'DOX',
  'DPS',
  'DPZ',
  'DRC',
  'DRE',
  'DRH',
  'DRI',
  'DRII',
  'DRIV',
  'DRL',
  'DRQ',
  'DRTX',
  'DSCI',
  'DSPG',
  'DST',
  'DSW',
  'DTE',
  'DTLK',
  'DTSI',
  'DTV',
  'DUK',
  'DV',
  'DVA',
  'DVAX',
  'DVN',
  'DVR',
  'DW',
  'DWA',
  'DWRE',
  'DWSN',
  'DX',
  'DXCM',
  'DXLG',
  'DXM',
  'DXPE',
  'DXYN',
  'DY',
  'DYAX',
  'DYN',
  'EA',
  'EAC',
  'EAT',
  'EBAY',
  'EBF',
  'EBIX',
  'EBS',
  'EBSB',
  'EBTC',
  'ECHO',
  'ECL',
  'ECOL',
  'ECOM',
  'ECPG',
  'ECYT',
  'ED',
  'EDE',
  'EDIG',
  'EDMC',
  'EDR',
  'EE',
  'EEFT',
  'EFII',
  'EFSC',
  'EFX',
  'EGAN',
  'EGBN',
  'EGHT',
  'EGL',
  'EGN',
  'EGOV',
  'EGP',
  'EGY',
  'EHTH',
  'EIG',
  'EIGI',
  'EIX',
  'EL',
  'ELGX',
  'ELLI',
  'ELNK',
  'ELRC',
  'ELS',
  'ELX',
  'ELY',
  'EMC',
  'EMCI',
  'EME',
  'EMN',
  'EMR',
  'END',
  'ENDP',
  'ENH',
  'ENOC',
  'ENPH',
  'ENR',
  'ENS',
  'ENSG',
  'ENT',
  'ENTA',
  'ENTG',
  'ENTR',
  'ENV',
  'ENVE',
  'ENZ',
  'ENZN',
  'EOG',
  'EOPN',
  'EOX',
  'EPAM',
  'EPAY',
  'EPIQ',
  'EPL',
  'EPM',
  'EPZM',
  'EQIX',
  'EQR',
  'EQT',
  'EQU',
  'EQY',
  'ERA',
  'ERIE',
  'ERII',
  'ES',
  'ESBF',
  'ESC',
  'ESCA',
  'ESE',
  'ESGR',
  'ESI',
  'ESIO',
  'ESL',
  'ESPR',
  'ESRT',
  'ESRX',
  'ESS',
  'ESSA',
  'ESV',
  'ETFC',
  'ETH',
  'ETM',
  'ETN',
  'ETR',
  'EV',
  'EVC',
  'EVER',
  'EVR',
  'EVRY',
  'EVTC',
  'EW',
  'EWBC',
  'EXAC',
  'EXAM',
  'EXAR',
  'EXAS',
  'EXC',
  'EXEL',
  'EXH',
  'EXL',
  'EXLS',
  'EXP',
  'EXPD',
  'EXPE',
  'EXPO',
  'EXPR',
  'EXR',
  'EXTR',
  'EXXI',
  'EZPW',
  'F',
  'FAF',
  'FANG',
  'FARM',
  'FARO',
  'FAST',
  'FB',
  'FBC',
  'FBHS',
  'FBIZ',
  'FBNC',
  'FBNK',
  'FBP',
  'FBRC',
  'FC',
  'FCBC',
  'FCEL',
  'FCF',
  'FCFS',
  'FCN',
  'FCNCA',
  'FCS',
  'FCSC',
  'FCX',
  'FDEF',
  'FDML',
  'FDO',
  'FDP',
  'FDS',
  'FDUS',
  'FDX',
  'FE',
  'FEIC',
  'FELE',
  'FET',
  'FF',
  'FFBC',
  'FFBH',
  'FFG',
  'FFIC',
  'FFIN',
  'FFIV',
  'FFKT',
  'FFNW',
  'FHCO',
  'FHN',
  'FIBK',
  'FICO',
  'FII',
  'FINL',
  'FIO',
  'FIS',
  'FISI',
  'FISV',
  'FITB',
  'FIVE',
  'FIX',
  'FIZZ',
  'FL',
  'FLDM',
  'FLIC',
  'FLIR',
  'FLO',
  'FLR',
  'FLS',
  'FLT',
  'FLTX',
  'FLWS',
  'FLXS',
  'FMBI',
  'FMC',
  'FMD',
  'FMER',
  'FMI',
  'FN',
  'FNB',
  'FNF',
  'FNFG',
  'FNGN',
  'FNHC',
  'FNLC',
  'FNSR',
  'FOE',
  'FOLD',
  'FOR',
  'FORM',
  'FORR',
  'FOSL',
  'FOX',
  'FOXA',
  'FOXF',
  'FPO',
  'FPRX',
  'FR',
  'FRAN',
  'FRBK',
  'FRC',
  'FRED',
  'FRF',
  'FRGI',
  'FRM',
  'FRME',
  'FRNK',
  'FRO',
  'FRP',
  'FRT',
  'FRX',
  'FSC',
  'FSGI',
  'FSL',
  'FSLR',
  'FSP',
  'FSS',
  'FST',
  'FSTR',
  'FSYS',
  'FTD',
  'FTI',
  'FTK',
  'FTNT',
  'FTR',
  'FUBC',
  'FUEL',
  'FUL',
  'FULT',
  'FURX',
  'FVE',
  'FWM',
  'FWRD',
  'FXCB',
  'FXCM',
  'FXEN',
  'G',
  'GABC',
  'GAIA',
  'GAIN',
  'GALE',
  'GARS',
  'GAS',
  'GB',
  'GBCI',
  'GBDC',
  'GBL',
  'GBLI',
  'GBNK',
  'GBX',
  'GCA',
  'GCAP',
  'GCI',
  'GCO',
  'GD',
  'GDOT',
  'GDP',
  'GE',
  'GEF',
  'GEO',
  'GEOS',
  'GERN',
  'GES',
  'GEVA',
  'GFF',
  'GFIG',
  'GFN',
  'GGG',
  'GGP',
  'GHC',
  'GHDX',
  'GHL',
  'GHM',
  'GIFI',
  'GIII',
  'GILD',
  'GIMO',
  'GIS',
  'GK',
  'GLAD',
  'GLDD',
  'GLF',
  'GLNG',
  'GLOG',
  'GLPW',
  'GLRE',
  'GLT',
  'GLUU',
  'GLW',
  'GM',
  'GMAN',
  'GMCR',
  'GME',
  'GMED',
  'GMO',
  'GMT',
  'GNC',
  'GNCMA',
  'GNE',
  'GNMK',
  'GNRC',
  'GNTX',
  'GNW',
  'GOGO',
  'GOOD',
  'GOOG',
  'GOOGL',
  'GORO',
  'GOV',
  'GPC',
  'GPI',
  'GPK',
  'GPN',
  'GPOR',
  'GPRE',
  'GPS',
  'GPX',
  'GRA',
  'GRC',
  'GRIF',
  'GRMN',
  'GRPN',
  'GRT',
  'GS',
  'GSAT',
  'GSBC',
  'GSIG',
  'GSIT',
  'GSM',
  'GSOL',
  'GST',
  'GSVC',
  'GT',
  'GTAT',
  'GTI',
  'GTIV',
  'GTLS',
  'GTN',
  'GTS',
  'GTXI',
  'GTY',
  'GUID',
  'GVA',
  'GWR',
  'GWRE',
  'GWW',
  'GXP',
  'GY',
  'H',
  'HA',
  'HAE',
  'HAFC',
  'HAIN',
  'HAL',
  'HALL',
  'HALO',
  'HAR',
  'HAS',
  'HASI',
  'HAWK',
  'HAYN',
  'HBAN',
  'HBCP',
  'HBHC',
  'HBI',
  'HBIO',
  'HBNC',
  'HCA',
  'HCBK',
  'HCC',
  'HCCI',
  'HCI',
  'HCKT',
  'HCN',
  'HCOM',
  'HCP',
  'HCSG',
  'HD',
  'HDNG',
  'HE',
  'HEES',
  'HEI',
  'HELE',
  'HEOP',
  'HERO',
  'HES',
  'HF',
  'HFC',
  'HFWA',
  'HGG',
  'HGR',
  'HHC',
  'HHS',
  'HI',
  'HIBB',
  'HIFS',
  'HIG',
  'HII',
  'HIIQ',
  'HIL',
  'HILL',
  'HITK',
  'HITT',
  'HIW',
  'HK',
  'HL',
  'HLF',
  'HLIT',
  'HLS',
  'HLSS',
  'HLX',
  'HME',
  'HMN',
  'HMPR',
  'HMST',
  'HMSY',
  'HMTV',
  'HNH',
  'HNI',
  'HNRG',
  'HNT',
  'HOFT',
  'HOG',
  'HOLX',
  'HOMB',
  'HOME',
  'HON',
  'HOS',
  'HOT',
  'HOV',
  'HP',
  'HPP',
  'HPQ',
  'HPT',
  'HPTX',
  'HPY',
  'HR',
  'HRB',
  'HRC',
  'HRG',
  'HRL',
  'HRS',
  'HRZN',
  'HSC',
  'HSH',
  'HSIC',
  'HSII',
  'HSNI',
  'HSP',
  'HST',
  'HSTM',
  'HSY',
  'HT',
  'HTBI',
  'HTBK',
  'HTCH',
  'HTCO',
  'HTGC',
  'HTH',
  'HTLD',
  'HTLF',
  'HTS',
  'HTWR',
  'HTZ',
  'HUBG',
  'HUM',
  'HUN',
  'HURC',
  'HURN',
  'HVB',
  'HVT',
  'HW',
  'HWAY',
  'HWCC',
  'HWKN',
  'HXL',
  'HY',
  'HZNP',
  'HZO',
  'I',
  'IACI',
  'IART',
  'IBCA',
  'IBCP',
  'IBKC',
  'IBKR',
  'IBM',
  'IBOC',
  'IBTX',
  'ICE',
  'ICEL',
  'ICFI',
  'ICGE',
  'ICON',
  'ICPT',
  'ICUI',
  'IDA',
  'IDCC',
  'IDIX',
  'IDRA',
  'IDT',
  'IDTI',
  'IDXX',
  'IEX',
  'IFF',
  'IFT',
  'IG',
  'IGT',
  'IGTE',
  'IHC',
  'IHS',
  'IIIN',
  'IILG',
  'IIVI',
  'IL',
  'ILMN',
  'IM',
  'IMGN',
  'IMI',
  'IMKTA',
  'IMMR',
  'IMMU',
  'IMN',
  'IMPV',
  'INAP',
  'INCY',
  'INDB',
  'INFA',
  'INFI',
  'INFN',
  'INGR',
  'ININ',
  'INN',
  'INO',
  'INSM',
  'INSY',
  'INT',
  'INTC',
  'INTL',
  'INTU',
  'INTX',
  'INVN',
  'INWK',
  'IO',
  'IOSP',
  'IP',
  'IPAR',
  'IPCC',
  'IPCM',
  'IPG',
  'IPGP',
  'IPHI',
  'IPHS',
  'IPI',
  'IPXL',
  'IQNT',
  'IR',
  'IRBT',
  'IRC',
  'IRDM',
  'IRET',
  'IRF',
  'IRG',
  'IRM',
  'IRWD',
  'ISBC',
  'ISCA',
  'ISH',
  'ISIL',
  'ISIS',
  'ISLE',
  'ISRG',
  'ISRL',
  'ISSC',
  'ISSI',
  'IT',
  'ITC',
  'ITG',
  'ITIC',
  'ITMN',
  'ITRI',
  'ITT',
  'ITW',
  'IVAC',
  'IVC',
  'IVR',
  'IVZ',
  'JACK',
  'JAH',
  'JAKK',
  'JBHT',
  'JBL',
  'JBLU',
  'JBSS',
  'JBT',
  'JCI',
  'JCOM',
  'JCP',
  'JDSU',
  'JEC',
  'JGW',
  'JIVE',
  'JJSF',
  'JKHY',
  'JLL',
  'JMBA',
  'JNJ',
  'JNPR',
  'JNS',
  'JNY',
  'JOE',
  'JONE',
  'JOUT',
  'JOY',
  'JPM',
  'JRN',
  'JWN',
  'K',
  'KAI',
  'KALU',
  'KAMN',
  'KAR',
  'KBH',
  'KBR',
  'KCG',
  'KCLI',
  'KEG',
  'KELYA',
  'KEM',
  'KERX',
  'KEX',
  'KEY',
  'KEYW',
  'KFRC',
  'KFY',
  'KIM',
  'KIRK',
  'KKD',
  'KLAC',
  'KMB',
  'KMG',
  'KMI',
  'KMPR',
  'KMT',
  'KMX',
  'KND',
  'KNL',
  'KNX',
  'KO',
  'KOG',
  'KOP',
  'KOPN',
  'KORS',
  'KOS',
  'KR',
  'KRA',
  'KRC',
  'KRFT',
  'KRG',
  'KRO',
  'KS',
  'KSS',
  'KSU',
  'KTOS',
  'KVHI',
  'KWK',
  'KWR',
  'KYTH',
  'L',
  'LABL',
  'LAD',
  'LAMR',
  'LANC',
  'LAYN',
  'LAZ',
  'LB',
  'LBAI',
  'LBMH',
  'LBTYA',
  'LBY',
  'LCI',
  'LCNB',
  'LCUT',
  'LDL',
  'LDOS',
  'LDR',
  'LDRH',
  'LEA',
  'LECO',
  'LEE',
  'LEG',
  'LEN',
  'LF',
  'LFUS',
  'LFVN',
  'LG',
  'LGF',
  'LGIH',
  'LGND',
  'LH',
  'LHCG',
  'LHO',
  'LIFE',
  'LII',
  'LINC',
  'LINTA',
  'LION',
  'LIOX',
  'LKFN',
  'LKQ',
  'LL',
  'LLEN',
  'LLL',
  'LLNW',
  'LLTC',
  'LLY',
  'LM',
  'LMCA',
  'LMIA',
  'LMNR',
  'LMNX',
  'LMOS',
  'LMT',
  'LNC',
  'LNCE',
  'LNDC',
  'LNG',
  'LNKD',
  'LNN',
  'LNT',
  'LO',
  'LOCK',
  'LOGM',
  'LOPE',
  'LORL',
  'LOV',
  'LOW',
  'LPI',
  'LPLA',
  'LPNT',
  'LPSN',
  'LPX',
  'LQDT',
  'LRCX',
  'LRN',
  'LSCC',
  'LSI',
  'LSTR',
  'LTC',
  'LTM',
  'LTS',
  'LTXC',
  'LUB',
  'LUK',
  'LUV',
  'LVLT',
  'LVNTA',
  'LVS',
  'LWAY',
  'LXK',
  'LXP',
  'LXRX',
  'LXU',
  'LYB',
  'LYTS',
  'LYV',
  'LZB',
  'M',
  'MA',
  'MAC',
  'MACK',
  'MAIN',
  'MAN',
  'MANH',
  'MANT',
  'MAR',
  'MAS',
  'MASI',
  'MAT',
  'MATW',
  'MATX',
  'MBFI',
  'MBI',
  'MBII',
  'MBRG',
  'MBVT',
  'MBWM',
  'MCBC',
  'MCC',
  'MCD',
  'MCF',
  'MCGC',
  'MCHP',
  'MCHX',
  'MCK',
  'MCO',
  'MCP',
  'MCRI',
  'MCRL',
  'MCRS',
  'MCS',
  'MCY',
  'MD',
  'MDAS',
  'MDC',
  'MDCA',
  'MDCI',
  'MDCO',
  'MDLZ',
  'MDP',
  'MDR',
  'MDRX',
  'MDSO',
  'MDT',
  'MDU',
  'MDVN',
  'MDW',
  'MDXG',
  'MEAS',
  'MED',
  'MEG',
  'MEI',
  'MEIP',
  'MENT',
  'MET',
  'METR',
  'MFA',
  'MFLX',
  'MFRM',
  'MG',
  'MGAM',
  'MGEE',
  'MGI',
  'MGLN',
  'MGM',
  'MGNX',
  'MGRC',
  'MHFI',
  'MHGC',
  'MHK',
  'MHLD',
  'MHO',
  'MHR',
  'MIDD',
  'MIG',
  'MILL',
  'MIND',
  'MINI',
  'MITK',
  'MITT',
  'MJN',
  'MKC',
  'MKL',
  'MKSI',
  'MKTO',
  'MKTX',
  'MLAB',
  'MLHR',
  'MLI',
  'MLM',
  'MLNK',
  'MLR',
  'MM',
  'MMC',
  'MMI',
  'MMM',
  'MMS',
  'MMSI',
  'MN',
  'MNI',
  'MNK',
  'MNKD',
  'MNRO',
  'MNST',
  'MNTA',
  'MNTX',
  'MO',
  'MOD',
  'MODN',
  'MOFG',
  'MOH',
  'MON',
  'MORN',
  'MOS',
  'MOSY',
  'MOV',
  'MOVE',
  'MPAA',
  'MPC',
  'MPO',
  'MPWR',
  'MPX',
  'MRC',
  'MRCY',
  'MRGE',
  'MRH',
  'MRIN',
  'MRK',
  'MRLN',
  'MRO',
  'MRTN',
  'MRVL',
  'MS',
  'MSA',
  'MSCC',
  'MSCI',
  'MSEX',
  'MSFG',
  'MSFT',
  'MSG',
  'MSI',
  'MSL',
  'MSM',
  'MSO',
  'MSTR',
  'MTB',
  'MTD',
  'MTDR',
  'MTG',
  'MTGE',
  'MTH',
  'MTN',
  'MTOR',
  'MTRN',
  'MTRX',
  'MTSC',
  'MTSI',
  'MTW',
  'MTX',
  'MTZ',
  'MU',
  'MUR',
  'MUSA',
  'MVC',
  'MW',
  'MWA',
  'MWIV',
  'MWV',
  'MWW',
  'MXIM',
  'MXL',
  'MXWL',
  'MYCC',
  'MYE',
  'MYGN',
  'MYL',
  'MYRG',
  'N',
  'NANO',
  'NASB',
  'NAT',
  'NATH',
  'NATI',
  'NATL',
  'NATR',
  'NAV',
  'NAVB',
  'NAVG',
  'NAVI',
  'NBBC',
  'NBCB',
  'NBHC',
  'NBIX',
  'NBL',
  'NBR',
  'NBTB',
  'NC',
  'NCFT',
  'NCI',
  'NCLH',
  'NCMI',
  'NCR',
  'NCS',
  'NDAQ',
  'NDLS',
  'NDSN',
  'NE',
  'NEE',
  'NEM',
  'NEO',
  'NEOG',
  'NEON',
  'NES',
  'NETE',
  'NEU',
  'NEWP',
  'NEWS',
  'NFBK',
  'NFG',
  'NFLX',
  'NFX',
  'NGPC',
  'NGS',
  'NGVC',
  'NHC',
  'NI',
  'NICK',
  'NIHD',
  'NILE',
  'NJR',
  'NKE',
  'NKSH',
  'NKTR',
  'NL',
  'NLNK',
  'NLS',
  'NLSN',
  'NLY',
  'NMFC',
  'NMIH',
  'NMRX',
  'NNBR',
  'NNI',
  'NOC',
  'NOG',
  'NOR',
  'NOV',
  'NOW',
  'NP',
  'NPBC',
  'NPK',
  'NPO',
  'NPSP',
  'NPTN',
  'NR',
  'NRCIA',
  'NRG',
  'NRIM',
  'NRZ',
  'NSC',
  'NSIT',
  'NSM',
  'NSP',
  'NSPH',
  'NSR',
  'NSTG',
  'NTAP',
  'NTCT',
  'NTGR',
  'NTK',
  'NTLS',
  'NTRI',
  'NTRS',
  'NU',
  'NUAN',
  'NUE',
  'NUS',
  'NUTR',
  'NUVA',
  'NVAX',
  'NVDA',
  'NVEC',
  'NVR',
  'NWBI',
  'NWE',
  'NWL',
  'NWLI',
  'NWN',
  'NWPX',
  'NWSA',
  'NWY',
  'NX',
  'NXST',
  'NXTM',
  'NYCB',
  'NYLD',
  'NYMT',
  'NYNY',
  'NYT',
  'O',
  'OABC',
  'OAS',
  'OB',
  'OC',
  'OCFC',
  'OCLR',
  'OCN',
  'OCR',
  'ODC',
  'ODFL',
  'ODP',
  'OEH',
  'OFC',
  'OFG',
  'OFIX',
  'OFLX',
  'OGE',
  'OGS',
  'OGXI',
  'OHI',
  'OHRP',
  'OI',
  'OII',
  'OIS',
  'OKE',
  'OKSB',
  'OLED',
  'OLN',
  'OLP',
  'OMC',
  'OMCL',
  'OME',
  'OMED',
  'OMER',
  'OMEX',
  'OMG',
  'OMI',
  'OMN',
  'ONB',
  'ONE',
  'ONNN',
  'ONTY',
  'OPEN',
  'OPHT',
  'OPK',
  'OPLK',
  'OPY',
  'ORA',
  'ORB',
  'ORBC',
  'ORCL',
  'OREX',
  'ORI',
  'ORIT',
  'ORLY',
  'ORN',
  'OSIR',
  'OSIS',
  'OSK',
  'OSTK',
  'OSUR',
  'OTTR',
  'OUTR',
  'OVAS',
  'OVTI',
  'OWW',
  'OXM',
  'OXY',
  'OZRK',
  'P',
  'PACB',
  'PACR',
  'PACW',
  'PAG',
  'PANW',
  'PATK',
  'PATR',
  'PAY',
  'PAYX',
  'PB',
  'PBCT',
  'PBF',
  'PBH',
  'PBI',
  'PBPB',
  'PBY',
  'PBYI',
  'PCAR',
  'PCBK',
  'PCCC',
  'PCG',
  'PCH',
  'PCL',
  'PCLN',
  'PCO',
  'PCP',
  'PCRX',
  'PCTI',
  'PCYC',
  'PCYG',
  'PCYO',
  'PDCE',
  'PDCO',
  'PDFS',
  'PDLI',
  'PE',
  'PEBO',
  'PEG',
  'PEGA',
  'PEI',
  'PEIX',
  'PENN',
  'PENX',
  'PEP',
  'PERY',
  'PES',
  'PETM',
  'PETS',
  'PETX',
  'PF',
  'PFBC',
  'PFE',
  'PFG',
  'PFLT',
  'PFMT',
  'PFPT',
  'PFS',
  'PFSI',
  'PG',
  'PGC',
  'PGEM',
  'PGI',
  'PGNX',
  'PGR',
  'PGTI',
  'PH',
  'PHH',
  'PHIIK',
  'PHM',
  'PHMD',
  'PHX',
  'PICO',
  'PII',
  'PIKE',
  'PIR',
  'PJC',
  'PKD',
  'PKE',
  'PKG',
  'PKI',
  'PKOH',
  'PKT',
  'PKY',
  'PL',
  'PLAB',
  'PLCE',
  'PLCM',
  'PLD',
  'PLKI',
  'PLL',
  'PLMT',
  'PLOW',
  'PLPC',
  'PLPM',
  'PLT',
  'PLUG',
  'PLUS',
  'PLXS',
  'PLXT',
  'PM',
  'PMC',
  'PMCS',
  'PMFG',
  'PMT',
  'PNC',
  'PNFP',
  'PNK',
  'PNM',
  'PNNT',
  'PNR',
  'PNRA',
  'PNW',
  'PNX',
  'PNY',
  'PODD',
  'POL',
  'POM',
  'POOL',
  'POR',
  'POST',
  'POWI',
  'POWL',
  'POWR',
  'POZN',
  'PPBI',
  'PPC',
  'PPG',
  'PPHM',
  'PPL',
  'PPO',
  'PPS',
  'PQ',
  'PRA',
  'PRAA',
  'PRE',
  'PRFT',
  'PRGO',
  'PRGS',
  'PRGX',
  'PRI',
  'PRIM',
  'PRK',
  'PRKR',
  'PRLB',
  'PRO',
  'PROV',
  'PRSC',
  'PRTA',
  'PRU',
  'PRXL',
  'PSA',
  'PSB',
  'PSEC',
  'PSEM',
  'PSIX',
  'PSMI',
  'PSMT',
  'PSTB',
  'PSUN',
  'PSX',
  'PTCT',
  'PTEN',
  'PTGI',
  'PTIE',
  'PTLA',
  'PTP',
  'PTRY',
  'PTSI',
  'PTX',
  'PVA',
  'PVH',
  'PVTB',
  'PWOD',
  'PWR',
  'PX',
  'PXD',
  'PZG',
  'PZN',
  'PZZA',
  'Q',
  'QADA',
  'QCOM',
  'QCOR',
  'QDEL',
  'QEP',
  'QGEN',
  'QLGC',
  'QLIK',
  'QLTY',
  'QLYS',
  'QNST',
  'QSII',
  'QTM',
  'QTS',
  'QUAD',
  'QUIK',
  'R',
  'RAD',
  'RAI',
  'RAIL',
  'RALY',
  'RAS',
  'RATE',
  'RAVN',
  'RAX',
  'RBC',
  'RBCAA',
  'RBCN',
  'RCAP',
  'RCII',
  'RCKB',
  'RCL',
  'RCPT',
  'RDC',
  'RDEN',
  'RDI',
  'RDN',
  'RE',
  'RECN',
  'REG',
  'REGI',
  'REGN',
  'REIS',
  'RELL',
  'REMY',
  'REN',
  'RENT',
  'RES',
  'RESI',
  'REV',
  'REX',
  'REXI',
  'REXR',
  'REXX',
  'RF',
  'RFMD',
  'RFP',
  'RGA',
  'RGC',
  'RGDO',
  'RGEN',
  'RGLD',
  'RGLS',
  'RGR',
  'RGS',
  'RH',
  'RHI',
  'RHT',
  'RIG',
  'RIGL',
  'RJET',
  'RJF',
  'RKT',
  'RKUS',
  'RL',
  'RLD',
  'RLGY',
  'RLI',
  'RLJ',
  'RLOC',
  'RM',
  'RMBS',
  'RMD',
  'RMTI',
  'RNDY',
  'RNET',
  'RNG',
  'RNR',
  'RNST',
  'RNWK',
  'ROC',
  'ROCK',
  'ROG',
  'ROIAK',
  'ROIC',
  'ROK',
  'ROL',
  'ROLL',
  'ROP',
  'ROSE',
  'ROST',
  'ROVI',
  'RP',
  'RPM',
  'RPRX',
  'RPT',
  'RPTP',
  'RPXC',
  'RRC',
  'RRD',
  'RRGB',
  'RRTS',
  'RS',
  'RSE',
  'RSG',
  'RSH',
  'RSPP',
  'RST',
  'RSTI',
  'RSYS',
  'RT',
  'RTEC',
  'RTI',
  'RTIX',
  'RTK',
  'RTN',
  'RUSHA',
  'RUTH',
  'RVBD',
  'RVLT',
  'RWT',
  'RXN',
  'RYL',
  'RYN',
  'S',
  'SAAS',
  'SAFM',
  'SAFT',
  'SAH',
  'SAIA',
  'SAIC',
  'SALE',
  'SALM',
  'SAM',
  'SAMG',
  'SANM',
  'SAPE',
  'SASR',
  'SATS',
  'SAVE',
  'SBAC',
  'SBCF',
  'SBGI',
  'SBH',
  'SBNY',
  'SBRA',
  'SBSI',
  'SBUX',
  'SBY',
  'SCAI',
  'SCBT',
  'SCCO',
  'SCG',
  'SCHL',
  'SCHN',
  'SCHW',
  'SCI',
  'SCL',
  'SCLN',
  'SCM',
  'SCMP',
  'SCOR',
  'SCS',
  'SCSC',
  'SCSS',
  'SCTY',
  'SCVL',
  'SD',
  'SDRL',
  'SE',
  'SEAC',
  'SEAS',
  'SEB',
  'SEE',
  'SEIC',
  'SEM',
  'SEMG',
  'SENEA',
  'SF',
  'SFE',
  'SFG',
  'SFL',
  'SFLY',
  'SFNC',
  'SFXE',
  'SFY',
  'SGA',
  'SGEN',
  'SGI',
  'SGK',
  'SGMO',
  'SGMS',
  'SGNT',
  'SGY',
  'SGYP',
  'SHEN',
  'SHLD',
  'SHLM',
  'SHLO',
  'SHO',
  'SHOO',
  'SHOR',
  'SHOS',
  'SHW',
  'SIAL',
  'SIF',
  'SIG',
  'SIGA',
  'SIGI',
  'SIGM',
  'SIMG',
  'SIR',
  'SIRI',
  'SIRO',
  'SIVB',
  'SIX',
  'SJI',
  'SJM',
  'SJW',
  'SKH',
  'SKT',
  'SKUL',
  'SKX',
  'SKYW',
  'SLAB',
  'SLB',
  'SLCA',
  'SLG',
  'SLGN',
  'SLH',
  'SLM',
  'SLRC',
  'SLXP',
  'SM',
  'SMA',
  'SMCI',
  'SMG',
  'SMP',
  'SMRT',
  'SMTC',
  'SN',
  'SNA',
  'SNAK',
  'SNBC',
  'SNCR',
  'SNDK',
  'SNH',
  'SNHY',
  'SNI',
  'SNMX',
  'SNPS',
  'SNSS',
  'SNTA',
  'SNV',
  'SNX',
  'SO',
  'SON',
  'SONC',
  'SONS',
  'SP',
  'SPA',
  'SPAR',
  'SPB',
  'SPF',
  'SPG',
  'SPLK',
  'SPLS',
  'SPN',
  'SPNC',
  'SPNS',
  'SPPI',
  'SPR',
  'SPRT',
  'SPSC',
  'SPTN',
  'SPW',
  'SPWR',
  'SQI',
  'SQNM',
  'SRCE',
  'SRCL',
  'SRDX',
  'SRE',
  'SREV',
  'SRI',
  'SRPT',
  'SSD',
  'SSI',
  'SSNC',
  'SSNI',
  'SSP',
  'SSS',
  'SSTK',
  'SSYS',
  'STAA',
  'STAG',
  'STAR',
  'STBA',
  'STBZ',
  'STC',
  'STCK',
  'STE',
  'STFC',
  'STI',
  'STJ',
  'STL',
  'STLD',
  'STML',
  'STMP',
  'STNG',
  'STNR',
  'STR',
  'STRA',
  'STRL',
  'STRT',
  'STRZA',
  'STSA',
  'STSI',
  'STT',
  'STWD',
  'STX',
  'STZ',
  'SUBK',
  'SUI',
  'SUNE',
  'SUNS',
  'SUP',
  'SUPN',
  'SUPX',
  'SUSQ',
  'SUSS',
  'SVU',
  'SVVC',
  'SWC',
  'SWFT',
  'SWHC',
  'SWI',
  'SWK',
  'SWKS',
  'SWM',
  'SWN',
  'SWS',
  'SWSH',
  'SWX',
  'SWY',
  'SXC',
  'SXI',
  'SXT',
  'SYA',
  'SYBT',
  'SYK',
  'SYKE',
  'SYMC',
  'SYNA',
  'SYNT',
  'SYRG',
  'SYUT',
  'SYX',
  'SYY',
  'SZYM',
  'T',
  'TAHO',
  'TAL',
  'TAM',
  'TAP',
  'TASR',
  'TAST',
  'TAX',
  'TAXI',
  'TAYC',
  'TBBK',
  'TBI',
  'TBNK',
  'TCAP',
  'TCB',
  'TCBI',
  'TCBK',
  'TCO',
  'TCPC',
  'TCRD',
  'TCS',
  'TDC',
  'TDG',
  'TDS',
  'TDW',
  'TDY',
  'TE',
  'TEAR',
  'TECD',
  'TECH',
  'TECUA',
  'TEG',
  'TEL',
  'TEN',
  'TER',
  'TESO',
  'TESS',
  'TEX',
  'TFM',
  'TFSL',
  'TFX',
  'TG',
  'TGE',
  'TGH',
  'TGI',
  'TGT',
  'TGTX',
  'THC',
  'THFF',
  'THG',
  'THLD',
  'THO',
  'THOR',
  'THR',
  'THRM',
  'THRX',
  'THS',
  'TIBX',
  'TICC',
  'TIF',
  'TILE',
  'TIME',
  'TIS',
  'TISI',
  'TITN',
  'TIVO',
  'TJX',
  'TK',
  'TKR',
  'TLYS',
  'TMH',
  'TMHC',
  'TMK',
  'TMO',
  'TMP',
  'TMUS',
  'TNAV',
  'TNC',
  'TNGO',
  'TNK',
  'TOL',
  'TOWN',
  'TOWR',
  'TPC',
  'TPH',
  'TPLM',
  'TPRE',
  'TPX',
  'TQNT',
  'TR',
  'TRAK',
  'TRC',
  'TREC',
  'TREE',
  'TREX',
  'TRGP',
  'TRGT',
  'TRI',
  'TRIP',
  'TRK',
  'TRLA',
  'TRMB',
  'TRMK',
  'TRMR',
  'TRN',
  'TRNO',
  'TRNX',
  'TROW',
  'TROX',
  'TRR',
  'TRS',
  'TRST',
  'TRV',
  'TRW',
  'TSC',
  'TSCO',
  'TSLA',
  'TSN',
  'TSO',
  'TSRA',
  'TSRO',
  'TSS',
  'TSYS',
  'TTC',
  'TTEC',
  'TTEK',
  'TTGT',
  'TTI',
  'TTMI',
  'TTPH',
  'TTS',
  'TTWO',
  'TUES',
  'TUMI',
  'TUP',
  'TW',
  'TWC',
  'TWER',
  'TWGP',
  'TWI',
  'TWIN',
  'TWMC',
  'TWO',
  'TWTC',
  'TWTR',
  'TWX',
  'TXI',
  'TXMD',
  'TXN',
  'TXRH',
  'TXT',
  'TXTR',
  'TYC',
  'TYL',
  'TYPE',
  'TZOO',
  'UA',
  'UACL',
  'UAL',
  'UAM',
  'UBA',
  'UBNK',
  'UBNT',
  'UBSH',
  'UBSI',
  'UCBI',
  'UCFC',
  'UCP',
  'UCTT',
  'UDR',
  'UEC',
  'UEIC',
  'UFCS',
  'UFI',
  'UFPI',
  'UFPT',
  'UFS',
  'UGI',
  'UHAL',
  'UHS',
  'UHT',
  'UIHC',
  'UIL',
  'UIS',
  'ULTA',
  'ULTI',
  'ULTR',
  'UMBF',
  'UMH',
  'UMPQ',
  'UNF',
  'UNFI',
  'UNH',
  'UNIS',
  'UNM',
  'UNP',
  'UNS',
  'UNT',
  'UNTD',
  'UNXL',
  'UPIP',
  'UPL',
  'UPS',
  'URBN',
  'URG',
  'URI',
  'URS',
  'USAK',
  'USAP',
  'USB',
  'USCR',
  'USG',
  'USLM',
  'USM',
  'USMD',
  'USMO',
  'USNA',
  'USPH',
  'USTR',
  'UTEK',
  'UTHR',
  'UTI',
  'UTIW',
  'UTL',
  'UTMD',
  'UTX',
  'UVE',
  'UVSP',
  'UVV',
  'V',
  'VAC',
  'VAL',
  'VAR',
  'VASC',
  'VC',
  'VCRA',
  'VCYT',
  'VDSI',
  'VECO',
  'VFC',
  'VG',
  'VGR',
  'VHC',
  'VIAB',
  'VIAS',
  'VICL',
  'VICR',
  'VITC',
  'VIVO',
  'VLGEA',
  'VLO',
  'VLY',
  'VMC',
  'VMEM',
  'VMI',
  'VMW',
  'VNDA',
  'VNO',
  'VNTV',
  'VOCS',
  'VOLC',
  'VOXX',
  'VOYA',
  'VPFG',
  'VPG',
  'VPRT',
  'VR',
  'VRA',
  'VRNG',
  'VRNT',
  'VRSK',
  'VRSN',
  'VRTS',
  'VRTU',
  'VRTX',
  'VSAT',
  'VSEC',
  'VSH',
  'VSI',
  'VSTM',
  'VTG',
  'VTNR',
  'VTR',
  'VVC',
  'VVI',
  'VVTV',
  'VVUS',
  'VZ',
  'WAB',
  'WABC',
  'WAC',
  'WAFD',
  'WAG',
  'WAGE',
  'WAIR',
  'WAL',
  'WASH',
  'WAT',
  'WBA',
  'WBC',
  'WBCO',
  'WBMD',
  'WBS',
  'WCC',
  'WCG',
  'WCIC',
  'WCN',
  'WD',
  'WDAY',
  'WDC',
  'WDFC',
  'WDR',
  'WEC',
  'WEN',
  'WERN',
  'WETF',
  'WEX',
  'WEYS',
  'WFC',
  'WFD',
  'WFM',
  'WG',
  'WGL',
  'WGO',
  'WHF',
  'WHG',
  'WHR',
  'WIBC',
  'WIFI',
  'WIN',
  'WINA',
  'WIRE',
  'WLB',
  'WLH',
  'WLK',
  'WLL',
  'WLP',
  'WLT',
  'WM',
  'WMAR',
  'WMB',
  'WMC',
  'WMGI',
  'WMK',
  'WMT',
  'WNC',
  'WNR',
  'WOOF',
  'WOR',
  'WPP',
  'WPX',
  'WR',
  'WRB',
  'WRE',
  'WRES',
  'WRI',
  'WRLD',
  'WSBC',
  'WSBF',
  'WSFS',
  'WSM',
  'WSO',
  'WST',
  'WSTC',
  'WSTL',
  'WTBA',
  'WTFC',
  'WTI',
  'WTM',
  'WTR',
  'WTS',
  'WTSL',
  'WTW',
  'WU',
  'WWAV',
  'WWD',
  'WWE',
  'WWW',
  'WWWW',
  'WY',
  'WYN',
  'WYNN',
  'X',
  'XCO',
  'XCRA',
  'XEC',
  'XEL',
  'XL',
  'XLNX',
  'XLRN',
  'XLS',
  'XNPT',
  'XOM',
  'XOMA',
  'XON',
  'XONE',
  'XOOM',
  'XOXO',
  'XPO',
  'XRAY',
  'XRM',
  'XRX',
  'XXIA',
  'XXII',
  'XYL',
  'Y',
  'YDKN',
  'YELP',
  'YHOO',
  'YORW',
  'YRCW',
  'YUM',
  'YUME',
  'Z',
  'ZAGG',
  'ZAZA',
  'ZBRA',
  'ZEP',
  'ZEUS',
  'ZGNX',
  'ZIGO',
  'ZINC',
  'ZION',
  'ZIOP',
  'ZIXI',
  'ZLC',
  'ZLTQ',
  'ZMH',
  'ZNGA',
  'ZQK',
  'ZTS',
  'ZUMZ' ];


// Order Ascending, Only return Adjusted Closing Price
//https://www.quandl.com/api/v1/datasets/WIKI/BLUE.json?column=11&sort_order=asc&trim_start=2012-01-01&trim_end=2013-12-31&auth_token=GCfKzLJiwuSxucYgqHMq

//var stocks = ["REGN","AAPL","BLUE"]

var counter = 0;
var last_stock = stocks[stocks.length-1];    

// take worst performing stocks and short

//var start_date = "2007-01-01";
//var end_date = "2010-12-27"; // recommended to start on a open trading day of the week, probably some function to set to monday
var end_date = "2015-07-13"
//var end_date = "2007-09-10"
// var start_date ="2006-07-25";
// var end_date = "2015-07-04";

var set = moment(end_date, "YYYY-MM-DD").add(1, 'weeks').format('dddd');
if(set == "Tuesday"){end_date = moment(end_date, "YYYY-MM-DD").add(6, 'days').format('YYYY-MM-DD')}
if(set == "Wednesday"){end_date = moment(end_date, "YYYY-MM-DD").add(5, 'days').format('YYYY-MM-DD')}
if(set == "Thursday"){end_date = moment(end_date, "YYYY-MM-DD").add(4, 'days').format('YYYY-MM-DD')}
if(set == "Friday"){end_date = moment(end_date, "YYYY-MM-DD").add(3, 'days').format('YYYY-MM-DD')}
if(set == "Saturday"){end_date = moment(end_date, "YYYY-MM-DD").add(2, 'days').format('YYYY-MM-DD')}
if(set == "Sunday"){end_date = moment(end_date, "YYYY-MM-DD").add(1, 'days').format('YYYY-MM-DD')}

console.log(end_date);

// var start_date = "2012-06-26"; // Represents entire range
// var end_date = "2015-06-26";   // Must change these values to represent, first period below
// //var periods = [["2014-06-26","2015-06-26"],["2015-03-26","2015-06-26"],["2015-05-26","2015-06-26"]]; // could probably just replcaed period 1 with start_date, end_date

var batches = []; // three periods make up a batch

// TODO: Test the Crash
// TODO: run simulations for all possible combinations and determine mean, std, etc.
for (var i = 0; i < 20; i++) { //180 // 1 years, 6 months, 2 months, //400
  var anchor = moment(end_date, "YYYY-MM-DD").subtract(i, 'weeks').format('YYYY-MM-DD')
  var period1 = moment(anchor, "YYYY-MM-DD").subtract(12, 'months').format('YYYY-MM-DD')
  var period2 = moment(anchor, "YYYY-MM-DD").subtract(6, 'months').format('YYYY-MM-DD')
  var period3 = moment(anchor, "YYYY-MM-DD").subtract(2, 'months').format('YYYY-MM-DD')

  var batch = [[period1, anchor],[period2, anchor],[period3, anchor]];
  batches.push(batch);
};


//var data = require('./data/constant/backtest_data.json');
//var data = require('./data/constant/backtest_data_2007-01-01_to_2011-01-01.json')
var data = require('./data/constant/backtest_data_2_2007-01-01_to_2015-07-13.json')

backtest(loop_batches(batches));

function backtest (results){

  var backtest_stocks = [];
  for (var i = 0; i < results.length; i++) {
    backtest_stocks.push(select_stocks(results[i]));
  };

  var total_returns = [];
  for (var i = 1; i < backtest_stocks.length; i++) { // // 1 since we dont have data a week ahead of most recent selection
    var period_returns = [];
    for (var j = 0; j < backtest_stocks[i].length; j++) {
      period_returns.push(get_returns(backtest_stocks[i][j]));
    }
    total_returns.push(period_returns);
  };
  console.log(total_returns);

  var complete_returns = [];
  for (var i = 0; i < total_returns.length; i++) {
    var period_returns_consolidated = [];
    for (var j = 0; j < total_returns[i].length; j++) {
      period_returns_consolidated.push(total_returns[i][j]['return'])
    };
    complete_returns.push({'end_date':total_returns[i][0]['end_date'], 'return':ss.mean(period_returns_consolidated)}) // end_date based on the end_date of the first stock in the period/batch
  };
  console.log(complete_returns);

  var batch_results = [];
  for (var i = 0; i < complete_returns.length; i++) {
    batch_results.push(complete_returns[i]['return'])
  }

  var backtest_result = ss.sum(batch_results);
  var backtest_start =  moment(complete_returns[complete_returns.length -1]['end_date'], "YYYY-MM-DD").subtract(1, 'weeks').format('YYYY-MM-DD');
  var backtest_end = complete_returns[0]['end_date'];
  console.log(backtest_result +' for '+backtest_start+' to '+backtest_end);


  // Get SPY data for backtest time period
  var request_url = 'https://www.quandl.com/api/v1/datasets/YAHOO/INDEX_SPY.json?column=6&sort_order=desc&trim_start='+backtest_start+'&trim_end='+backtest_end+'&auth_token=GCfKzLJiwuSxucYgqHMq'
  
  request(request_url, function (error, response, body) {
    if (!error && response.statusCode == 200) {
      body = JSON.parse(body);
      
      // turn to object for easier access
      var data = {};
      for (var i = 0; i < body.data.length; i++) {
        data[body.data[i][0]] = body.data[i][1]
      };
      console.log(data);

      var spy_returns = [];
      for (var i = complete_returns.length - 1; i >= 0; i--) {
        var period_end = complete_returns[i]['end_date'];
        var period_start = moment(complete_returns[i]['end_date'], "YYYY-MM-DD").subtract(1, 'weeks').format('YYYY-MM-DD')
        //console.log(period_end, period_start)
        var period_return;

        period_return = (data[period_end]/data[period_start]) -1;
        console.log(period_end, period_start, data[period_end], data[period_start], period_return);
        if (data[period_start] && data[period_end]){
          period_return = (data[period_end]/data[period_start]) - 1;
        } else {
          period_return = 0; // fallback to just 0, probably need to change for more accuracy
        }
        spy_returns.push(period_return);
      }
      console.log(spy_returns);
      
      //clean up complete_returns into single array format
      var cleaned_complete = [];

      for (var i = complete_returns.length - 1; i >= 0; i--) {
        if(complete_returns[i]['return']){
          cleaned_complete.push(complete_returns[i]['return'])
        } else {
          cleaned_complete.push(0) /////////////////////// need to change this to better represent data !!!!!!!!!
        }
      };
      console.log(cleaned_complete);

      // track intial capital
      var spy_capital_record = [];
      var spy_capital_reg = [];
      var spy_control_record = [];
      var complete_capital_record = [];

      var spy_predictor_record = [];

      var spy_capital = 100000
      var spy_control = 100000
      var complete_capital = 100000

      // Observation: why the continous falls - preventable? - always seems to be a beginning dip? Lack of Data?
      // Observation: shorter time periods perform worse why?
      // Observation: 12 month, 6 month, 2 month seem to be best why?
      // Observation 1 and 0 instead of 0.1 and 0.9 seem to be better why?
      // why does these stop and hold techniques work better for our selected batch instead of the SPY?
      // TODO: test regular monthly capital injections
      // TODO: what happens when you also short the worst performing stocks?


      // TODO: random walk - see large number of simulations, maybe 1000?
      // TODO: weighted regression - maybe increase the reg period to more than 3
      // TODO: penalty for gains right after zero
      // TODO: weighted random walk?
      // TODO; stopgap based on daily values

      spy_capital_reg.push(spy_capital);
      spy_capital_record.push(spy_capital);
      spy_control_record.push(spy_control);
      //spy_predictor_record.push(NaN);
      complete_capital_record.push(complete_capital); // makes dates off by one week!!!!!!!!!!!!!!!!!!!!!


      // TODO: run simulation for all possible weights
      for (var i = 0; i < cleaned_complete.length; i++) { // clean_complete.length should equal spy_returns.length
        
        // ALGORITHM
        // if (i > 1){
        //   var complete_capital = ((cleaned_complete[i] + 1) * complete_capital * weight_a)+(complete_capital * weight_b);
        //   complete_capital_record.push(complete_capital);
        //   spy_predictor_record.push(100000);

        /////////////////

        if(i > 0 && complete_capital_record[complete_capital_record.length -1] < complete_capital_record[complete_capital_record.length -2]){
          var complete_capital = ((cleaned_complete[i] + 1) * complete_capital * 0)+(complete_capital * 1);
          complete_capital_record.push(complete_capital);
          spy_predictor_record.push(NaN); /// <--- consider this momentum !!!
        // } else if (i > 1 && complete_capital_record[complete_capital_record.length -1] == complete_capital_record[complete_capital_record.length -2] && spy_predictor_weight < 0 ){
        //   var complete_capital = ((cleaned_complete[i] + 1) * complete_capital * weight_a)+(complete_capital * weight_b);
        //   complete_capital_record.push(complete_capital);
        //   spy_predictor_record.push(100000);
        } else {
          var complete_capital = ((cleaned_complete[i] + 1) * complete_capital * 1) + (complete_capital * 0);
          complete_capital_record.push(complete_capital);
          spy_predictor_record.push(NaN);
        }
        // if(i > 0 && spy_capital_record[spy_capital_record.length -1] < spy_capital_record[spy_capital_record.length -2]){
        //   var complete_capital = ((cleaned_complete[i] + 1) * complete_capital * 0)+(complete_capital * 1);
        //   complete_capital_record.push(complete_capital);
        // } else {
        //   var complete_capital = (cleaned_complete[i] + 1) * complete_capital;
        //   complete_capital_record.push(complete_capital);
        // }

        // SPY BENCHMARK
        var spy_capital = (spy_returns[i] + 1) * spy_capital;
        spy_capital_record.push(spy_capital);
        spy_capital_reg.push(spy_capital); /// do we need to account for initial 100,000?

        // SPY CONTROL
        if(i > 0 && spy_control_record[spy_control_record.length -1] < spy_control_record[spy_control_record.length -2]){
          var spy_control = ((spy_returns[i] + 1) * spy_control * 0)+(spy_control * 1);
          spy_control_record.push(spy_control)
        } else if (i > 1 && spy_control_record[spy_control_record.length -1] == spy_control_record[spy_control_record.length -2] && spy_capital_record[spy_capital_record.length -1] < spy_capital_record[spy_capital_record.length -2] ){
          var spy_control = ((spy_returns[i] + 1) * spy_control * 0)+(spy_control * 1);
          spy_control_record.push(spy_control)
        } else {
          var spy_control = (spy_returns[i] + 1) * spy_control;
          spy_control_record.push(spy_control)
        }
      };

      //console.log(ss.sum(spy_returns));
      //console.log(ss.sum(cleaned_complete));

      //push data to /public
      io.sockets.on('connection', function (socket) {
        socket.emit('simulation_returns', {'algorithm':complete_capital_record, 'spy':spy_capital_record, 'spy_control':spy_control_record, 'spy_predictor':spy_predictor_record, 'start_date':backtest_start});
      })
    }
  })
}

///// 
function get_returns(backtest_stock){
  for (var i = 0; i < data.length; i++) {
    if(data[i].ticker == backtest_stock.ticker){

      console.log(backtest_stock);
      // using these calculations we are selling all previous stocks every monday close, and buying new stocks every monday close 
      var period_end = moment(backtest_stock.period_start, "YYYY-MM-DD").add(1, 'weeks').format('YYYY-MM-DD');
      console.log(moment(backtest_stock.period_start, "YYYY-MM-DD").add(1, 'weeks').format('dddd'));
      
      var result = {"ticker": data[i].ticker} //"start_date":backtest_stock.period_start, "end_date":period_end};

      var return_results = [];
      for (var j = 0; j < data[i].data.length; j++) {
        if(backtest_stock.period_start == data[i].data[j][0]){
          if (data[i].data[j]){
            return_results.push(data[i].data[j][1]);
            result['start_date'] = backtest_stock.period_start;
          } else {
            if(data[i].data[j+3][1]){
              return_results.push(data[i].data[j+3][1]); // buy on next available day close
              result['start_date'] = data[i].data[j+3][0];
            }
            if(data[i].data[j+2][1]){
              return_results.push(data[i].data[j+2][1]); // buy on next available day close
              result['start_date'] = data[i].data[j+2][0];
            }
            if(data[i].data[j+1][1]){
              return_results.push(data[i].data[j+1][1]); // buy on next available day close
              result['start_date'] = data[i].data[j+1][0];
            }
          }
        }
        if(period_end == data[i].data[j][0]){
          if (data[i].data[j]){
            return_results.push(data[i].data[j][1]);
            result["end_date"] = period_end;
          } else {
            if(data[i].data[j+3][1]){
              return_results.push(data[i].data[j+3][1]); // sell on next available day close
              result["end_date"] = data[i].data[j+3][0];
            }
            if(data[i].data[j+2][1]){
              return_results.push(data[i].data[j+2][1]); // sell on next available day close
              result["end_date"] = data[i].data[j+2][0];
            }
            if(data[i].data[j+1][1]){
              return_results.push(data[i].data[j+1][1]); // sell on next available day close
              result["end_date"] = data[i].data[j+1][0];
            }
          }
        }
      }
      result['return'] = (return_results[1] / return_results[0]) -1;
      return result;
    }
  }
}

function select_stocks(result){
  var top10_stocks = [];
  for (var i = result.length - 1; i >= result.length - 11; i--) {
    top10_stocks.push(result[i]);
  };
  return top10_stocks;
}

function loop_batches (batches){
  var results = [];
  for (var i = 0; i < batches.length; i++) {
    var result = batch_analysis(loop_data(data, batches[i]), batches[i]);
    results.push(result);
    console.log(batches[i]);
  };

  jf.spaces = 1;
  var file = 'data/backtest_results.json';
  jf.writeFile(file, results, function(err) {
    if(err){console.log(err);}
    console.log("Score Results Logged");
  });

  return results;
}


function loop_data (data, periods){
  var collection = [];
  for (var i = 0; i < data.length; i++) {
    collection.push(calculate(data[i],periods));
  };
  return collection;
};

function calculate (body, periods){
  // for each time period specified /////////////////////
  var results = [];
  for (var i = 0; i < periods.length; i++) {

    // individual stock data collection /////////////////
    var data = [];
    var x_value = 0;
    for (var j = 0; j < body.data.length; j++) {
      if (body.data[j][0] >= periods[i][0] && body.data[j][0] <= periods[i][1]){
        data.push([x_value, body.data[j][1]]) //console.log(body.data[j][0],x_value,body.data[j][1])
        x_value++;
      }
    }

    //data analysis ////////////////////////////////////
    var slope = ss.linear_regression().data(data).m();
    var r_squared_func =  ss.linear_regression().data(data).line();
    var r_squared = ss.r_squared(data, r_squared_func);

    results.push({'slope': slope, 'r_squared': r_squared, 'period': periods[i]});
  };
  return {"ticker": body.ticker, 'results': results};
};


function batch_analysis(collection, periods){
  var analysis = [];
  for (var i = 0; i < collection.length; i++) {
    analysis.push({'ticker':collection[i].ticker,'results':collection[i].results[0], 'ranks':[]});
  }

  for (var i = 0; i < periods.length; i++) {
    function compare(a,b) {
      if (a.results[i].slope * a.results[i].r_squared < b.results[i].slope * b.results[i].r_squared ) // maybe remove r_squared or else we're looking for things that too closely follow a line over a year (when it could have been a jump and then steady growth)
        return -1;
      if (a.results[i].slope * a.results[i].r_squared > b.results[i].slope * b.results[i].r_squared )
        return 1;
      return 0;
    }
    var sorted_collection = collection.sort(compare); 
    for (var j = 0; j < sorted_collection.length; j++) {
      for (var k = 0; k < analysis.length; k++) {
        if(sorted_collection[j].ticker == analysis[k].ticker){
          analysis[k].ranks.push(j);
        }
      }
    }
  }
  var analysis_score = [];
  for (var i = 0; i < analysis.length; i++) {
    analysis_score.push({'ticker': analysis[i].ticker, 'score':ss.mean(analysis[i].ranks), 'period_start':analysis[i].results.period[1]})
  };

  function compare_score(a,b) {
    if (a.score < b.score)
      return -1;
    if (a.score > b.score)
      return 1;
    return 0;
  }

  var analysis_score_sorted = analysis_score.sort(compare_score);
  //console.log(analysis);
  return analysis_score_sorted;
}